import React, { useState } from 'react';
import { graphql } from 'react-apollo';
import { flowRight as compose } from 'lodash'; 

/* Queries */
import { getAllPostsQuery } from '../queries/queries';

/* Mutations */
import { addPostMutation } from "../mutations/mutations"

const NewPost = (props) => {

  let [description, setDescription] = useState("At the beach");
  let [image, setImage] = useState("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxITEhUTEhMWFhUVFRUVFRcVFhgXFxUXFxUXFxUVFRUYHSggGB0lHRUVITEhJSkrLi4uFx8zODMsNygtLisBCgoKDg0OGxAQGy0mHyUrLS0tLS0tLS0tLS0uKy0tLS0tLS0tLS0tLS0vLS0yLS4tLS0tLi0tLS8tLS0tLS0tLf/AABEIAMIBAwMBIgACEQEDEQH/xAAbAAACAgMBAAAAAAAAAAAAAAAAAQQFAgMGB//EAEIQAAEDAgMEBwUFBwQBBQAAAAEAAhEDIQQSMQVBUWEGEyJxgZGhMkJSsfAUYsHR8QcVI1OCkuEzcqKyQxYXRGPS/8QAGgEBAQADAQEAAAAAAAAAAAAAAAECAwQFBv/EADQRAAIBAwIEAwYEBwEAAAAAAAABAgMREgQhEzFBUQWR8BRhgaGxwRVCcfEiMkNSYtHhI//aAAwDAQACEQMRAD8A9MoEOC4vpV0WeXOq0oM6tiPHmunoVY0KlCpIuvQpVZUZZROOrRhWjjI8nqbHrtn+GTBi1/kodSkWmCIPNeu1WDcvNekTT179frSF62l1TquzR42s0caEckyqhELOEQu0825hCcLMNRCC5hCcLMNU/A7Gq1QS0AAA3cY8FjKSirtmUISm7RVythOFv+zO7Vj2deS1Qqncxd1zCkBN9OWvgoO1QyLu5wTmJnSPdHiD4qfCT8KwxN44QL83a+S4NdRlUjZHo+H14U3/ABHMYLZxc6XN7OoF+18IiNPBbamDcT2tToeHDwt6Hgupdh2tYC3UxJ1udRzt+HNaHYUGC4yd/Pv9F48fDpSso8vqetPX043bKHBYIg35wP8Asz8R4cFPGEBJ5xPllJ/tiO5WJYJmPoaJlljGsQOUr0oad0KMnLe255ktUq9aMYbX2NOBpNDTIBgRfTS+vj58llQ28+Tls2S0zdotEt5kkfUBV1aqWywXBETrP1qscNhYziPcdqPiyhrhvFy08gvk3UqV5Xn+x9NCEaStEvqGIZUeZu/UAQ1jKY9lxM9gAR2iM3AFSNo7MbUHVvk8HAdpp+6Tv4j5HSjo40CrEZw3MBwkZSHOv2suaQLaTuldCdpBzQ0zAgB2k7ydN+m4DSLwuTUaapSquUL7MqnGcTlMThTS/huE5ge2YAcDYGSL7tSDbeqfb2FDTbXzIPwmJXoOMYxzSDLi0Fw5CQJBOhJfHzXPbR2G4OIecwjMHkQwtIkOAJ4czvWVCupbsxlE4ZziTfWbzqe9bms7XipNfBwQRe/mARccr66WU3YOyTXqBsEjUxuExmJO6/1K7puyNKRnsh0mIzQCQy8wNXFrdR3/AIr0GjsBtPLVLi5we2SfdzvpNcwZR7IkmComwKPUN610va5j30mkNDmw5rWshus5p/olRK+NrV6jxTddxgDNAOSYgmxInQ8jppzSldbuyNkYdTdtfb4cTksztzIv/qsLbcg3XmuVdtYEhtS7cmW5kQGgCORAI7yJ4rDazqlJrmkQ6YJMSJsbbvn8zV4Ohnc4ES3kdCCb+RdbjC7KFBNpW5mFSVkzpCXB2UmS14Ic6JAy5muJO8yZO6CouMwpMkQSTAJvJBMwDo0XJ7hOsKwwzmvc3rDDcgBO8gez8z5qL0gqlokE5qstGnZpC5aOE274PAL0akFThZLZHLTect3uynZiKrhIzRJ0B4lNbKFURpvOk8ShaVaxvfM9kobSaN481tr7ba3UriGNO6UywniV73sUb7s8H8SnbaJ1I6TNXO7XxnWPJGhjxiYlRS1ItXRT08IO6OOtratWOMjBrCTA1WdTDluvyPzUjCENMnUKXi8YHiMvctkpyyslsYQpwcG29yuoZb5uFu9ZUKTTrx9E6IAMkStlQCZaI5cEb3MY8ruxd0W4cRa4AurHB4hrA4tIgrk6ZIW1uIeLTZck9PfqehT1qj+XyJmMxjcxJaAXG8XBCpqzRmOXTct9WXG6w6tdNOKijhr1XUfI05VlTsQYnlx4hbOrWQprY2c6TFiaznuzO1MeghaoUjqkCmsVZKyMpKUndmjKsgxb+qWbaSOSKqbIDtmuYWuPvPbl77nysB4hUWJrGjWzAGckf8YMDSzsp5QuxcZAHCYPAkR8iVyO36EVCIkAgA6CS1pI9fWV834hQw3irb7H1ehrqorN3fX6ETZTs1ZkN7JzDjLsoLh4tLR5LtqOzqkDs9kSQTb6n5rnuh1OXuDplhaWbtTBYT3tCvMzq73fCBA3NnOQQDxyglefXq2ouklz3b7ctvl5G5071VN9Pn6uQsdhqjZywSQM0OBsDMQ06TcqXg9qB2VtRoJY0w5wnK8EZTl3iJ8uSsWbNDRBykujMdx+7yFiqmn0drXeHNa9rgASYzHN5RGUgRx0XlqnBs6VN9ip2y1nWltjclxmfaaM0u45gfDuVvRxNCjQyYds55Lnb4AIE6TBE8pXKbVpVRNM0nB9NxNTKC4Bpb7RImG8DMXXS7IwoAmQBFwToYvpuNu+AvVo0IVFerKyRqrTcf5Fdsh18Y4tpNizAQTudmyHK4cRl9DrKk7GYC7rGkZTfK4EE2gGQYMTrrG7eni9kvq1Gl2UAahp0HDjMrndp7MxLCXOFTKDr7TY5kEgamy1paeMrp5JPle1/hzMXxJRtyfnb7E/pO5z6hB0DRJjWdI4QR/yVRsig42kgm4GhkiPKI8RCnYbHYhpAmRYgfOQNdf0kz0mAxk2cAZIIlrTv0371s9viqmbjt2uRUHhjf4lS+qQ2KlLjp8R3g8FQY2YgEh8mZ90GIjnZemYqhSqNiMpNrXaCbX3jvHFcN0h2VUpHM8EiR2mmQXaEzuFoAtuFl1zr0q8coy37Pb9zVTpVKUt47dymoCBA3SNRxQpOGpHKPHcOKFgm7cje7XPSdmOa3XUq0yNPwhUAYsxK+gnSyd7ngUtRjHFxJW1aDYBG61lV9WpRagU1theKtc5q1qkrpWIvVrdSwxJA0lbmN5LZTdBlWU30JClG/8AEY4vZTqYmxG8jcsaWC7BeZ4CPn3KTUrucMpNk3VTGXUBas52s+Zv4VLK65fcm7K6M9awOc/LIkACTylV+0dj1KMZxY2kGVY4PazmAABY7Q2o+oIOnqtUZ1s9+RunS03DsuZR5EBik5ExTXVkcHDI2RPIpPVphimReGRsiYpqV1aOrUyMuGR8iYYpIprJtNTMyVMiPhoJOgBJ7gJK5bDOFZlQOPtOzB3wOPZA7vZHcOS6bpfiaVLCEA/xKsUwOUgvPlI8QqDojQlhtZ150kEtj/q5ebqP/eqqfZX+J6umj7PTdTuXezsBklxs3M4hvEugiTw3Hu3b5FNoyC/vgxpaYIjcFKFM/P1/RGVa6vharTbnLbsjFa5xjZLcrRh3kRMbrGLZhPjlESsDgXkkOqHKbmeQ9L/NWoakRFzoNVv/AA2hhilbbn9zStdWyvf4HnWIxLmV3APzNqUxJB1bwI3yJtvXR7CeTTBAIcSe0bAge9I1vPlK5HGv617abQ1jQ83Ig9p0DOYmwjuk2XoGzdnGnTDHHNE+q8zTaVVZNdEerqq/Cgr82aBXyiRDnHQAgENi5J0aI3qThq+cCe0Hau9mSTEtJ0YNL6+hT6DQXCLOjNa51sOHeoVfEOLw5kNb2hJ+ERfkI3b9TaAuPV+HYXcffz93r79UZUNSp2Q9o7KaL6sBtUYIIvcEaFDcEA8AGzxILZ3CZgaXhZYXHF1QTanoWxA0gTzMeQnWVqxFVtN+WlU7JJIgiCD7QHA7x4LzqecJW+vq6OqSTX+jdR2hLM51Zao0jWDDo5i8f5ULE7TeXFjbtmdAWnfccDBkcyugpYMVKRkDO5pBJFs3xFvCwMKrbsl9N759k+8YhwiXQPdkujzXs0vDoxSq57Wv6/Q4nrXdwtuUzaWYBzQGggGMoMSJMEmYmdUKbUwTiSS8Dl1hEeAshdHFpL+ovNGN7/l+RfZEwxZhNe5keLgYBieRZwgBTIuBhkWQYsw1ZBgUyLgasiYYtwamGqZDA1BieRbYThTIYGnInkW6EQmQwNORPItoanlUyLga8lkBi2ALIBMi4GoMWQYtkJwpkXA43b+CdWrjNZoc1jBxBBk+Lh6BTehRmhBEOp9g87lzXDkQ4eStNuYYup9nUOa4f0uzfgFvwWFyElogO/Ufj5rRCGNRyOqUk6WJu6tY9WpMJ5VvUzm4dyIWLTiqOZjm/E1wnhIiVYlir9t1MlFxBg2A03kDf4qSqpRbYjRbkku5weyNhl+KIe0ZYJdcgObGUFtgZnLfiV3vVwIHhvVR0QwxNSo4gAZWgACNXOJMSRJj0C7L7Cwi2q5NHOMKd3zZ262nOpUsuSOXxNCpBgh1jug3tuVVia5FnM0m24u1HgOH6rsa+DkWJaRv/NVdbZZdao8RO4bjz7pV1NaEY7sw09GblsjkMc+2VjpuQTxMS50cNfAj4rUBcSd5Fxz115GV32P2VSDclNtycznkXp0wO1lm8km3eNcsrlmYaKhJEbw1t4AJEnkCIv8ACTvlfP1ZJu6R7EabSs2bNj7Uq03ZKr39U4hhe2DlkWILrG0am3ouorUKzodTrtrMHsjLkfymbE+M20XL7JwdR4mnEk5bgkOFjlcwe23SQL8LgBdR0epPZL2ZGsJ/iUpzMBOhpm8iRpewtvW+hqakIpJ7djCppqc92txUalJrQ19IBw1DhBHeCJQpuI22Guc3KwQTbr6Ig7xD35h3Hwshb/bF/YvL/hq9h/yfr4izJhyhfb6X8xvmExj6f8xvmvoLHi3RYASYCzeyBzVb+8KXxt80/wB4U/5g0nUcYWLTMlKJYNB4La2nb8FUjadL4wmNp0p9v671iypxLjIB960rX4Kt/elL4/mn+9aI/wDIPAO/JQrlEsgQsmC8GyqXbWpfFPgU/wB8UviPfBQmUS1IRKrRtal8foVtw20abj/qNFj7Tg3dzKj2CcW9mTmrYGc7qoG2aQJaXRBMmCRYxYtme9A23R+P/i7z0R3CnDuvMtJRmVQ/blIGxJHEA/iFmzbVG0uInXsmBbjEnyQmce680WuZZAqpO2qPxH+0/kittyk0S0lx4QR6kKFzh3Xmi2MFbGtsqJu3mxpedO1p35deSVLbwvLQNdC653e6o79vkVVKfWS80X5aQsqTZKoht5vwnxLtf7Uztxt4F47PtXPMZbBTf0i8Wn3Xmi8yqm6WEjDkgkQ9kkRMZwN5A3qN++6lrM8BU/ELHaeONSk6nLDnBBP8QWixAy2M/gtdROUGrPyNkK1KMk8lt70LojWGd4tLmBwuL5XEE2H3wuuFSBuXkYx76D6bhmz03aaAt1e3xHz8V0GxNuvqnMKzc1/4b849Q0iO5cdColFQa3O3URs+Int3Ov2ttI02iLlzso7zxncqWti2sDmlloJJLZLydwcPZkxpr5Q63W1AGvdRLZmIq30/+uW79+9SKOCqlxeXUngx2HdYABHukMBB11kCdCsa9FzlffyJQ1VNKya80aq2ODshcBJs7cIJMU44Dy3c0sXhqTetFNrRDBT13kkOJ5hsXHelV6MYmvWNRho0mzAY1xeGZQBqWiTY7lvrdDsU4zmEg/d7QAGW2e1weOoXG6LWx2qpfcqcNhqTWOvoHZRJBGriQRpEkD/aT322CbSzCt2m56YcYgzD8jg4xxIM8J0hc90g2JWwdHPU994pCHD2i1zpgHdB9VbV+jGNpssQBBgSCBbloNFg4PoZZbXLd1dh/wDJGliwk2Eah4HoheY4jpBUzHPIdoRA3aekJJw6hjxYl2MMOPqtjcKOKmCm7h81uAPH8fxX0rmfBXb6lYcKEjgwrSpP0P8AK0u+tUUySm11K/7IOaBhBwKsQwnd6FH2d3D0VyMeM+5B+yN+ErJuEbwKlnCH6AWYwR4/JTIZvuRThGkyZPen9jYpzcE3eUfYxulTMzfe5XOwrfqEhRbxHkpztnd/n/hA2dzVyNbnbqQuoby8kdU3krEbOH1K2DAtTImXvKvqm8AshTbwCtRg2hbW0G8AmZbyZTikOCG0fu/Xkr5tEfdWYpN3kDyCjqpGyNCrLkijFFxOn15LMYNx3fJXgoUz74E8wFtbs1v88Duc0/isHqIo6I+HaiXQohs936BbG7OPB39quhs1h/8Akn0/BbWbFHu16p/203OWD1K9JnTDweq/5vqc7hmtfmyBxyuLXQBYjUKUzCH+XUP9Ksdm9G30+sLXYgZ6jndlobmnRxzRdTmbJxG4Yg/7qzQPGNFr9s2Oz8Ep362OW2p0eNYWo1Q8Awcsg8nBcPtXZFSi4NqMcx24OBExfMDvC9mbsrGaDI3m6pUefKYWqt0TqVARVrsg6htJvzsuGrKNR5cmevpqPAhgrtfQ8y2N0trUjFYdZTETPtt7nb/Fdtgul9FzZptP9RAI77ctxVB0n6IUmPDMPVdUeBdnVxwu1+lhxjvXK9S+g8ES17TYaER+ixVaS2kbPZ4Xyitz0XEdKyYhrdQ7siSSJiSSQdSk/pHin3nKOPaHfcMKquiHSKgHudimSTIBDRabyQNxg33RzVptvFUazg6m0NbHZGUSeLnROvfoAjqxSviZKnJu2RyvTnbuei1hqCo9tVpLQ6oXDsuElrrAX3Df3roK+2qb2uDH0X6SGteYnm55G42hUO3WZKDntYIc7qs2QgAuaSZdEAwDaZvKstkbXwmEpChXwTjVF6heS2o5xHwuZbdEbgtanld8jY42SRXjZ7DfJTE3/wBMIVidpPdfrn0xAhjCMrGgQ1oteBAnekpxf18ycNe4kBpJ3/XcsjS+7Pmp4pLcyly/Fe45I+BVKTK4UvuwsjTO4KyFILF1JTMPTlb1Tt9lkKR4nzU8Ycb/AJLNtAfoE4iItLJkAUFubRVgzD8GrezAOPAb9FrlWR1Q0E3yRWtolZ9TZW9PZc7ye7/CnUtj/dtz/NanqEdlPwyT5nNNpStjMG46NXUjAMGpHcL+q2NawD2SfEBa3qux1w8HXU5lmynHgFKo7AnUT4BXvWR7LWj19SsXvcdXFa3qJPqdcPCqK5oqxsVjdQ365LfT2dT3NH9oU+lhibjzKkU8DxPktbqSfU64aSjHlErRgqQ931/ILdSwbD7NMd9/zCtKeDaN3ndbw2FhkzaoRXJFSNjgmSGjuUinsiiL5ATxN1PWOa0ymTMrI1swzBo1o7gAtsqvx+2KdHLmntGARHrda6HSHDPMCoARucC35rG5bFpmSJWNN4dcEEclFxm1aNL23R9buKAmLCoYaYEkA2FptoDuVE7pdhpMFxgxMQD3SVJwu3WPgZHidPZM+qA4bb+36rX1CWGmA1oDT7XZIDnmR99pA5LnNrUm1Kkvr0c4EEOJa5otLS5zAJkXAcbr2PauyKOJaBWZNrXgidQD9aDgqSr+z3BOJc8VHFxJJzAXJnc1YOLuZJnkFVjGuJD2mALtmLiwuNb7rc1I2fi2hzWVG9gwHDQbvZLfZPMDkvTqv7NMGT2XVWi1g5p05lqgbY/Zm3JOGquNQXDaxbkdbTM1stPO4+aWaLdHIbf6OuyN6iq6pTd2msglwytMl0HKYnUXuYGq52ttGq8jrJcWggZiSRG65twhdDh69fDVi2q1zXNlpB90EiTYw7QQR4FdIzDYXHFudvbc4NzNdlqG4GsHNYe8D3omGjjMPtF2UewO+jRcfMskpL1H/wBqsLuq1vNn/wCELLFmN0VzKRO4re3CO4K5ZS4CfBbWYc8AF2PUM8KHhyKduAcf8fqtrNm8Z81bdWN7vIJkN3Ce+/otbrS7nVDw+HYr6Wz28FI+yDWB4lScxSyrU6kmdcNLCJhTpN1M+H6Le0sGjf7rrDL3LZToOdoFLs2qnFdDI4k7jHdZYF5OqlMwHE+S3twbBunvUM9itAJ09FsZhHHd5q0DQNBCcqkuQW4DifJb6eGaNw+a3poDENCaAlKgGhVG19qdXmAc0GPvOdcbmgePcuLr4zFAlwkQQA6SXaWuTvndr3JcqR6O+qG+0QO8gfNVO2dmZu00GY0a8N+ZAXHfY9pVGl2Wod4LoB8ARmK24Xo9jHt7Rcy/slztOJEwPXepcWK3bOyK7ZcQ4j7xDj3yHGVRuqZdQfJd7Q6Hvcf4tR5HDNEWdGpMXyacXcL78J0KZMvc49o2n3bgSRv0PiQhbnBU9q1WgtZUe3/a4j5aKLWxT3dpxJ5uMnxXqW0OhmHfSaxg6tzdHgAuNiIdpI/JcptPoJWpguY+nUE6w5pHG1xA70sLnKsxJaZBVyzpZVDQ0NaI3xJ/5SqSvgXhxAGnC418/NRwxQp1renGKt22wDpkBkcD+q3s6ZYp5A6wC82pgTyJuuNbTOsGPHn+R8lY4HaDqYvRaWjUw8OvvD2uEfJUh1eGx+0iOz1rheCAxwPf2CQuh2ZtLGPdkfRcyADnc2x9RfuVBszp1SptAfRq8iMp9SRPmp7/ANo2Fi1OsTwys+edAXu0NjMxDMuIAdwcAA5h4tdEj1XNbI6HPwtbrTVDwDNMBsCYgF97ESnW/aK2B1WHe7d23Bv/AFBlL/15VdMYNx/qcfPsKNIK51zdsACCQDvuhcBU6XYqbYN4HIOj1ahXNkxR2PWHikFlAW6lQc72Wnv0HmrYGrKU4CnU9nH3neA/NSmYVg92Tzv6aJYXKqnTc72QT9cVJp7PcfaIHddWEpKkuaaeEYN0963IQgBCUIUAIQgqgJSlNCgEgBCCgMXUxvA8kBkaJxdOEAiiU1jCAYQhCAFi9gIg38FkgqgotodF8O+XCmM8zIcWa82/kuYrdD8Q14c1tJzQZ7RJJ5EtAJ8R3wvQ5QSpYXPPK2Er0oc2gGPzAyKTagjf2wOwNTAutuHxVUAddSa2LA9W7LHAku9Ihd7Kd+KWLc5rBYfDPyu6qHH3qbKjBfiWkg6jeVe4XDtZ7Py/GLreAiEIZJJNFk0BkChay76v+SEFjOnhmN0b4m62ykhUg5SSQEKNJCJUAIRKEAihCaASEJIAlAQhACJQkgHKEgiUAIQFi13JAZIQJ3pBUACmhJQBKEIKoFCYCRSUBmUgViVmgBKUFIoBoWs1Bx9EICQhCQQDQkhANJCEAISQUA0FJIlANY96yCEAJEISQDQhI96AcoRKCEApTQEIBFBKaSAcpIQgBKE0QgFCySJQQgBEIRKAIRCChALMksw1CAaJSTQDSQEIBHv/AMplK87o9ZTQAhCEAISQHIACaUoQAUFBSAQDWIFr68llKIQCCXWCYm8TG+OMJuAOqTWDWLlAZIQUKgEoRKaAxB4brITKCoBgoSBTuqAShEpoBJSmQNeHpxQoACaSEA0IQqAQUIUAIKEIBpJIQDCEIQGITKEKFGEihCoGgIQqQCmUIQCCQQhAZJIQoAKQQhAhpFCEZUDU0IVIYhZBCFAASKEIEYrJqEIiszQhCpif/9k=");
  let userId = "5ef44a2ebf79686100afbd84";

  const submitForm = (e) => {
    console.log("running....");
    e.preventDefault();
    props.addPostMutation({ // addPostMutation refers to addPostMutation name (key) in the compose function at bottom of the page
      variables: {
        description: description,
        img: image,
        userId: userId
      },
      refetchQueries: [{ query: getAllPostsQuery }]
    })
  }

    return (
      <div className="share-form" onSubmit={(e) => submitForm(e)}>
        <form action="">
          <input type="text" placeholder="Write a caption.." name="post-description" /><br />
          <button>Share</button>
        </form>
      </div>

    )
  }

  export default compose(
    graphql(addPostMutation, { name: "addPostMutation" }),
    graphql(getAllPostsQuery, { name: "getAllPostsQuery" })
  )(NewPost);

  // export default graphql(addPostMutation)(NewPost);
